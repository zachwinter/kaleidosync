import{G as X,aa as Y,r as f,w as $,Q as j,d as z,ab as Z,J as ee,C as te,A as oe,c as ne,x as ae,y as se,a2 as le,e as ie,g as U,T as re,b as C,a as x,i as V,u as s,R as q,h as v,v as I,t as B,n as E,ac as ue,F as ce,a6 as S,o as L,ad as R,_ as pe,V as fe}from"./index-DmvewjL6.js";import"./index-D0Qh0Tnp.js";/* empty css                                                             */import{C as T}from"./Column-DyjFxAtN.js";function ge(){const _=X(),l=Y(),g=f(0),r=f([]),m=f({}),u=f(!1);let n=null;return $(()=>_.isOnHomepage,b=>{b&&l.connected?(l.emit("homepage:join"),n=e=>{if(!e){console.warn("âš ï¸ğŸ’€ Received null data in global update! Server bug detected!");return}if(e.coordinateCount===0&&e.packedFloatCount===0){g.value=e.totalUsers,r.value=[],m.value=e.activities,console.log(`âš¡ğŸ’€ No coordinates to unpack: ${e.totalUsers} users online`);return}if(typeof e.totalUsers!="number"||!(e.coordinates instanceof ArrayBuffer)||typeof e.coordinateCount!="number"||typeof e.packedFloatCount!="number"){console.warn("âš ï¸ğŸ’€ Invalid global update data:",e);return}g.value=e.totalUsers;const o=new Float32Array(e.coordinates),y=[],c=new ArrayBuffer(4),p=new Float32Array(c),d=new Uint32Array(c);for(let t=0;t<o.length;t+=2){p[0]=o[t];const k=d[0],i=k>>>24&255,O=k>>>16&255,P=k>>>8&255,D=k&255,N=t+1<o.length?(p[0]=o[t+1],d[0]):0,G=N>>>24&255,W=N>>>16&255,K=N>>>8&255,M=N&255;[{lat:i,lng:O},{lat:P,lng:D},{lat:G,lng:W},{lat:K,lng:M}].forEach(F=>{if(F.lat===0&&F.lng===0)return;const J=F.lat*180/255-90,Q=F.lng*360/255-180;y.push({lat:J,lng:Q})})}r.value=y.slice(0,e.coordinateCount),m.value=e.activities;const h=e.coordinates.byteLength,w=e.coordinateCount*8,A=((w-h)/w*100).toFixed(1),a=e.coordinateCount/e.packedFloatCount;console.log(`âš¡ğŸ’€ğŸ”¥ UNPACKED ULTRA 8-BIT MADNESS: ${e.totalUsers} users, ${e.coordinateCount} coords in ${e.packedFloatCount} floats (${a.toFixed(1)} coords/float), ${h} bytes (${A}% savings!)`)},l.on("active-space:global-update",n),u.value=!0,console.log("ğŸ âš¡ Joined homepage room AND subscribed to global updates!")):u.value&&(l.emit("homepage:leave"),n&&(l.off("active-space:global-update",n),n=null,console.log("ğŸ§¹ğŸ’€ Unsubscribed from global updates - no memory leaks!")),u.value=!1,console.log("ğŸšª Left homepage room"))},{immediate:!0}),$(()=>l.connected,b=>{b&&_.isOnHomepage&&!u.value&&(l.emit("homepage:join"),n||(n=e=>{if(!e){console.warn("âš ï¸ğŸ’€ Received null data in global update! Server bug detected!");return}if(e.coordinateCount===0&&e.packedFloatCount===0){g.value=e.totalUsers,r.value=[],m.value=e.activities,console.log(`âš¡ğŸ’€ RECONNECT: No coordinates to unpack: ${e.totalUsers} users online`);return}if(typeof e.totalUsers!="number"||!(e.coordinates instanceof ArrayBuffer)||typeof e.coordinateCount!="number"||typeof e.packedFloatCount!="number"){console.warn("âš ï¸ğŸ’€ Invalid global update data:",e);return}g.value=e.totalUsers;const o=new Float32Array(e.coordinates),y=[],c=new ArrayBuffer(4),p=new Float32Array(c),d=new Uint32Array(c);for(let a=0;a<o.length;a+=2){p[0]=o[a];const t=d[0],k=[{lat:t>>>24&255,lng:t>>>16&255},{lat:t>>>8&255,lng:t&255}];if(a+1<o.length){p[0]=o[a+1];const i=d[0];k.push({lat:i>>>24&255,lng:i>>>16&255},{lat:i>>>8&255,lng:i&255})}k.forEach(i=>{i.lat===0&&i.lng===0||y.push({lat:i.lat*180/255-90,lng:i.lng*360/255-180})})}r.value=y.slice(0,e.coordinateCount),m.value=e.activities;const h=e.coordinates.byteLength,w=e.coordinateCount*8,A=((w-h)/w*100).toFixed(1);console.log(`âš¡ğŸ’€ğŸ”¥ RECONNECT ULTRA UNPACK: ${e.totalUsers} users, ${h} bytes (${A}% savings!)`)}),l.on("active-space:global-update",n),u.value=!0,console.log("ğŸ”Œâš¡ Socket reconnected - rejoined homepage room and re-subscribed!"))}),j(()=>{u.value&&(l.emit("homepage:leave"),n&&(l.off("active-space:global-update",n),n=null,console.log("ğŸ§¹ğŸ’€ Unsubscribed from global updates on unmount")),u.value=!1,console.log("ğŸ§¹ Cleaned up homepage room on component unmount"))}),{totalUsers:g,locations:r,activities:m,joined:u}}const de=z({__name:"HomepageHero",setup(_){const l=Z(),g=ee(),r=te(),m=oe(),u=ge(),n=f(["Spotify","Audius","Radio Paradise","your voice"]),b=f(0),e=f(""),o=f(!1),y=ne(()=>n.value[b.value]);let c=f(!0),p;function d(){p=setInterval(()=>{o.value=!o.value},400)}async function h(){clearInterval(p),o.value=!1;const a=y.value;for(let t=0;t<=a.length;t++){if(!c.value)return;e.value=a.substring(0,t),await S(R(60,140))}d()}async function w(){clearInterval(p),o.value=!1;const a=e.value;for(let t=a.length;t>=0;t--){if(!c.value)return;e.value=a.substring(0,t),await S(R(30,120))}d()}async function A(){for(;c.value;)await h(),await S(3e3),await w(),b.value=(b.value+1)%n.value.length,await S(800)}return ae(()=>{A()}),se(()=>{clearInterval(p)}),j(()=>{c.value=!1}),le(()=>{g.onScroll(.5)}),(a,t)=>(L(),ie(ce,null,[U(re,{name:"fade"},{default:C(()=>[s(m).visible?V("",!0):(L(),x(s(q),{key:0,gap:"0.5",class:"active-users",align:"center",justify:"center"},{default:C(()=>[t[1]||(t[1]=v("i",{class:"dot"},null,-1)),v("span",null,[I(B(s(u).totalUsers)+" people seeing the music ",1),t[0]||(t[0]=v("strong",null,"right now",-1))])]),_:1,__:[1]}))]),_:1}),U(s(T),{class:"hero",align:"start",padding:s(l).isMobile?"1 1 1 1":"1 1 1 5",gap:"1",justify:"center"},{default:C(()=>[U(s(q),{align:"start",justify:"start",is:"h1"},{default:C(()=>[t[2]||(t[2]=v("span",null,"what",-1)),v("div",{ref:"div",class:E({empty:e.value.length===0})},[I(B(e.value),1),v("i",{class:E({blink:o.value})},"Â ",2)],2),t[3]||(t[3]=v("span",null,[v("strong",null,"LOOKS like")],-1))]),_:1,__:[2,3]}),s(r).isAuthenticated?V("",!0):(L(),x(s(T),{key:0,gap:"1"},{default:C(()=>[U(s(ue),{onClick:s(r).signIn,disabled:s(r).isAuthenticating},{default:C(()=>[I(B(s(r).isAuthenticating?"SIGNING IN...":"SIGN IN"),1)]),_:1},8,["onClick","disabled"])]),_:1}))]),_:1},8,["padding"])],64))}}),ve=pe(de,[["__scopeId","data-v-23ccc081"]]),me=z({__name:"index",setup(_){return(l,g)=>(L(),x(s(fe),null,{default:C(()=>[U(s(ve))]),_:1}))}}),be="Homepage",ye={description:"the homepage",requiresAuth:!1,redirectWhenAuthenticated:"/visualizer"},H={name:be,meta:ye};typeof H=="function"&&H(me);export{me as default};
//# sourceMappingURL=index-Cbwzow3Z.js.map
